<!doctype html>
<html lang="en">
<head>
	<title>Grails Asset-Pipeline Plugin</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=680, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="generator" content="https://github.com/sapegin/grunt-shower-markdown">
	<link rel="stylesheet" href="themes/ribbon/styles/screen.css">
	
		<link rel="stylesheet" href="styles/screen.css?1406402721000">
	
</head>
<body class="list">
	<header class="caption">
		<h1 id="grails-asset-pipeline-plugin">Grails Asset-Pipeline Plugin</h1>
<p>by <a href="https://twitter.com/tednaleid">@tednaleid</a></p>

	</header>

	
	<section class="slide quieter shout" ><div>
		<h1>Using Grails<br/>Asset-Pipeline</h1>
<h2>by <a href="https://twitter.com/tednaleid">@tednaleid</a></h2>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>What is an &#8220;asset&#8221;?</h1>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<h1>assets are &#8220;static&#8221; files<br/><br/>CSS, JavaScript, HTML &amp; Images</h1>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>Why do assets need a &#8220;pipeline&#8221;?</h1>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>the asset you should serve is not the asset you develop</h1>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<h1>JavaScript should be served concatenated, minified &amp; gzipped with long-lived cache headers</h1>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<h1>JavaScript should be developed<br/>as many small files</h1>
<h2>Just like your Groovy and Java code</h2>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<h1>Your source code might not even be JavaScript</h1>
<h2>(i.e. CoffeeScript, ClojureScript, ES6, Dart, TypeScript, …)</h2>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>The best place to do all of this is compile-time</h1>
<h2>then you&#39;re just serving static files</h2>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>Behavior<br/>With &amp; <span class="danger">Without</span><br/>Asset-Pipeline</h1>
<h2>(or the resources plugin)</h2>

	</div></section>
	
	<section class="slide small-code danger" ><div>
		<h2>Without Asset-Pipeline</h2>
<h1>Your layout is littered with tags</h1>
<pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/test-app/assets/main.css&quot; /&gt;</code>
<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/test-app/assets/mobile.css&quot; /&gt;</code>
<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/test-app/assets/application.css&quot; /&gt;</code>
<code>&shy;</code>
<code>&lt;script src=&quot;/test-app/assets/vendor/angular/angular-route.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/vendor/jquery/jquery.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/vendor/mongolab/mongolab-resource.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/admin.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/projects/admin-projects.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/users/admin-users-edit.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/users/admin-users-list.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/users/admin-users.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/users/uniqueEmail.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/admin/users/validateEquals.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/app.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/dashboard/dashboard.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/projects/productbacklog/productbacklog.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/projects/projects.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/projects/sprints/sprints.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/projects/sprints/tasks/tasks.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/app/projectsinfo/projectsinfo.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code>
<code>&lt;script src=&quot;/test-app/assets/application.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code></pre>
	</div></section>
	
	<section class="slide danger" ><div>
		<h2>Without Asset-Pipeline</h2>
<h1>Each tag is a request to the server</h1>
<img src="images/litter.png" alt="one request per tag" width="78%">

	</div></section>
	
	<section class="slide small-code push-content-down" ><div>
		<h2>With Asset-Pipeline</h2>
<h1>Assets transpiled, concatenated, minified, gzipped into one file per type</h1>
<pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/test-app/assets/application-08f92c4662379e3e9a56541af70c871c.css&quot;/&gt;</code>
<code>&shy;</code>
<code>&lt;script src=&quot;/test-app/assets/application-e1ec7cb3d4c455fac6e62f1faa6232f9.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;</code></pre>
	</div></section>
	
	<section class="slide push-content-down" ><div>
		<h2>With Asset-Pipeline</h2>
<h1>One server hit per file type</h1>
<img src="images/justonehit.png" alt="one request per asset type" width="100%">

	</div></section>
	
	<section class="slide danger" ><div>
		<h2>Without Asset-Pipeline</h2>
<h1>Browser cache isn&#39;t properly used</h1>
<img src="images/vanilla_grails_response.png" alt="Vanilla grails response, no gzipping, bad etag" width="73%">

	</div></section>
	
	<section class="slide " ><div>
		<h2>With Asset-Pipeline</h2>
<h1>Initial Request - Good Cache Headers</h1>
<img src="images/AP_grails_response.png" alt="etags, expires, gzipping, etc" width="100%">

	</div></section>
	
	<section class="slide " ><div>
		<h2>With Asset-Pipeline</h2>
<h1>Next Request - Cache Hit</h1>
<img src="images/AP_grails_cached_response.png" alt="etags, expires, gzipping, etc" width="90%">

	</div></section>
	
	<section class="slide danger push-content-down" ><div>
		<h2>Without Asset-Pipeline</h2>
<h1>Limited to browser-supported languages</h1>
<h2>i.e. CSS and JavaScript</h2>

	</div></section>
	
	<section class="slide push-content-down" ><div>
		<h2>With Asset-Pipeline</h2>
<h1>Can use anything that transpiles to browser-supported languages</h1>
<h2>ex: SASS, LESS, CoffeeScript, ClojureScript, Dart, TypeScript…</h2>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>Developing With Asset-Pipeline</h1>

	</div></section>
	
	<section class="slide " ><div>
		<h1>Files go in <code>grails-app/assets</code></h1>
<img src="images/assetdir.png" alt="assetdir" height="80%">

	</div></section>
	
	<section class="slide " ><div>
		<h1>TODO START HERE</h1>

	</div></section>
	
	<section class="slide " ><div>
		<h1>file types with manifest comments in them</h1>

	</div></section>
	
	<section class="slide " ><div>
		<h1>taglibs in gsps</h1>
<pre><code>  asset:image</code></pre>
	</div></section>
	
	<section class="slide " ><div>
		<h1>dev mode goes through asset controller</h1>

	</div></section>
	
	<section class="slide " ><div>
		<h1>assets served as individual files</h1>
<pre><code>show generated html</code></pre><p>set to never cache</p>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>How Asset-Pipeline Works In Production</h1>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<ul>
<li>war compilation</li>
<li>war creates manifest.properties file with etag mapping for each asset</li>
<li>static assets in <code>assets</code> folder in the war file</li>
</ul>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<ul>
<li><code>AssetPipelineFilter</code> added to <code>web.xml</code></li>
<li>request for asset meets filter</li>
<li>looks for file</li>
<li>not found 404</li>
<li>if found looks for etag in manifest</li>
<li>returns gzipped file with etag and <code>Vary: Accept-Encoding</code></li>
</ul>
<ul>
<li>cdn support?</li>
</ul>

	</div></section>
	
	<section class="slide quietest shout" ><div>
		<h1>Compilation Sausage Factory</h1>
<ul>
<li>AssetFile (1 per file)</li>
<li>processor</li>
<li>post processor?</li>
<li>look at plugin.groovy file for other details</li>
</ul>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>tips</h1>
<ul>
<li>angular mangling off for minifcation, or use angular plugin</li>
<li>cdn support</li>
<li>other plugins</li>
<li>write your own asset pipeline plugin</li>
</ul>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>Advantages over Resources Plugin</h1>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>no waiting to recompile in development</h1>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>precompilation means easier troubleshooting &amp; faster war startup</h1>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>dependencies are with assets</h1>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>Migrating from Resources Plugin</h1>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>TODO: insert resources rosetta stone</h1>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>Asset-Pipeline Alternatives</h1>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>gradle</h1>
<h2>weak JS support, not part of grails build without more work, doesn&#39;t solve caching/etags</h2>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>grunt/gulp</h1>
<h2>requires buy-in/support of node.js ecosystem, doesn&#39;t solve caching/etags</h2>

	</div></section>
	
	<section class="slide quieter shout" ><div>
		<h1>resources plugin</h1>
<h2>deprecated, more painful to work with</h2>

	</div></section>
	
	<section class="slide shout" ><div>
		<h1>Questions?</h1>

	</div></section>
	

	<div class="progress"><div></div></div>
	<script src="shower/shower.min.js"></script>

	
		<script src="node_modules/shower-core/shower.min.js?1404268286000"></script>
	

	

	<!-- Shower: http://shwr.me -->
</body>
</html>